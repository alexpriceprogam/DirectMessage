{"code":"module.exports=function(e){var r={};function t(n){if(r[n])return r[n].exports;var s=r[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&r&&\"string\"!=typeof e)for(var s in e)t.d(n,s,function(r){return e[r]}.bind(null,s));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,\"a\",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p=\"\",t(t.s=8)}([function(e,r){e.exports=require(\"express\")},function(e,r){throw new Error(\"Module build failed (from ./node_modules/babel-loader/lib/index.js):\\nSyntaxError: /home/adam/testingThis/DirectMessage/server/services/auth.services.js: Support for the experimental syntax 'exportDefaultFrom' isn't currently enabled (50:8):\\n\\n\u001b[0m \u001b[90m 48 | \u001b[39mpassport\u001b[33m.\u001b[39muse(jwtStrategy)\u001b[33m;\u001b[39m\u001b[0m\\n\u001b[0m \u001b[90m 49 | \u001b[39m\u001b[0m\\n\u001b[0m\u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 50 | \u001b[39m\u001b[36mexport\u001b[39m passport\u001b[33m;\u001b[39m\u001b[0m\\n\u001b[0m \u001b[90m    | \u001b[39m       \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\u001b[0m\\n\u001b[0m \u001b[90m 51 | \u001b[39m\u001b[0m\\n\u001b[0m \u001b[90m 52 | \u001b[39m\u001b[36mexport\u001b[39m \u001b[36mconst\u001b[39m authLocal \u001b[33m=\u001b[39m passport\u001b[33m.\u001b[39mauthenticate(\u001b[32m'local'\u001b[39m\u001b[33m,\u001b[39m { session\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m })\u001b[0m\\n\u001b[0m \u001b[90m 53 | \u001b[39m\u001b[36mexport\u001b[39m \u001b[36mconst\u001b[39m authJwt \u001b[33m=\u001b[39m passport\u001b[33m.\u001b[39mauthenticate(\u001b[32m'jwt'\u001b[39m\u001b[33m,\u001b[39m { session\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m })\u001b[33m;\u001b[39m\u001b[0m\\n\\nAdd @babel/plugin-proposal-export-default-from (https://git.io/vb4yH) to the 'plugins' section of your Babel config to enable transformation.\\n    at Parser.raise (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/parser/lib/index.js:3939:15)\\n    at Parser.expectPlugin (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5253:18)\\n    at Parser.parseExport (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/parser/lib/index.js:8156:12)\\n    at Parser.parseStatementContent (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/parser/lib/index.js:7240:27)\\n    at Parser.parseStatement (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/parser/lib/index.js:7153:17)\\n    at Parser.parseBlockOrModuleBlockBody (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/parser/lib/index.js:7707:23)\\n    at Parser.parseBlockBody (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/parser/lib/index.js:7694:10)\\n    at Parser.parseTopLevel (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/parser/lib/index.js:7118:10)\\n    at Parser.parse (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/parser/lib/index.js:8521:17)\\n    at parse (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/parser/lib/index.js:10513:38)\\n    at parser (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/core/lib/transformation/normalize-file.js:170:34)\\n    at normalizeFile (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/core/lib/transformation/normalize-file.js:138:11)\\n    at runSync (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/core/lib/transformation/index.js:44:43)\\n    at runAsync (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/core/lib/transformation/index.js:35:14)\\n    at process.nextTick (/home/adam/testingThis/DirectMessage/server/node_modules/@babel/core/lib/transform.js:34:34)\\n    at process._tickCallback (internal/process/next_tick.js:150:11)\")},function(e,r){e.exports=require(\"passport\")},function(e,r){e.exports=require(\"passport-local\")},function(e,r,t){\"use strict\";var n=u(t(5)),s=u(t(10)),o=u(t(11)),i=t(6),a=u(t(12));function u(e){return e&&e.__esModule?e:{default:e}}let d=new n.default.Schema({email:{type:String,unique:!0,required:[!0,\"Email address required!\"],validate:{validator:e=>s.default.isEmail(e)},message:\"{VALUE} is not a valid email.\"},name:{type:String,required:!0,max:100},password:{type:String},conversations:{type:[String]},friends:{type:[String]}});d.plugin(o.default,{message:\"{VALUE} already taken!\"}),d.pre(\"save\",function(e){return this.isModified(\"password\")&&(this.password=this._hashPassword(this.password)),e()}),d.methods={_hashPassword:e=>(0,i.hashSync)(e),authenticateUser(e){return(0,i.compareSync)(e,this.password)},createToken(){return a.default.sign({_id:this._id},\"SecretKey\")},toJSON(){return{_id:this._id,name:this.name,token:`JWT ${this.createToken()}`,email:this.email,friends:this.friends,conversations:this.conversations}}},e.exports=n.default.model(\"User\",d)},function(e,r){e.exports=require(\"mongoose\")},function(e,r){e.exports=require(\"bcrypt-nodejs\")},function(e,r,t){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0}),r.registerUser=async function(e,r){try{const t=await s.create(e.body);return console.log(t),r.status(201).json(t)}catch(e){return r.status(500).json(e)}},r.loginUser=function(e,r,t){n.passport.authenticate(\"local\",function(n,s,o){return n?t(n):s?void e.logIn(s,function(e){return e?t(e):r.send(s)}):r.redirect(\"/\")})(e,r,t),console.log(\"login user\");try{return console.log(e),console.log(e.user),r.status(200).json(e.user.toJSON()),t()}catch(e){return console.log(e),r.status(500).json(e)}},r.addFriend=function(e,r){console.log(e.body),console.log(e.body.loggedInUser._id);let t=o(e.body.loggedInUser._id),n=o(e.body.newFriend._id);s.findOneAndUpdate({_id:t},{$addToSet:{friends:n}},{new:!0},function(e,t){if(e)return handleError(e);r.send(t)})};var n=t(!function(){var e=new Error(\"Cannot find module '../services/auth.service'\");throw e.code=\"MODULE_NOT_FOUND\",e}());const s=t(4);t(0);let o=t(23).ObjectId;r.getUser=function(e,r){console.log(\"indexing users\");let t=\"\";s.find({name:\"Jimmy Testing\"},function(e,n){if(0!=n.length){for(let e=0;e<n.length;e++)t+=n[e].name;r.send(t)}else r.send(\"Sorry no user\")})},r.showUser=function(e,r){let t=new RegExp(e.params.query,\"i\");console.log(t),s.find({$or:[{email:t},{name:t}]},function(e,t){r.send(t)})},r.createUser=function(e,r){new s({name:e.body.name}).save(function(t){if(t)return console.log(t),next(t);r.send(\"Created user, \"+e.body.name)})},r.newUser=function(e,r){r.render(\"newUser\",{})},r.newRegisterUser=function(e,r){r.render(\"register\",{})},r.newLoginUser=function(e,r){r.render(\"register\",{})}},function(e,r,t){\"use strict\";var n=t(1);const s=t(0),o=(t(13),t(14)),i=(t(15)(o),t(16)),a=t(2),u=(t(3).Strategy,t(17),t(6),t(5)),d=t(18),l=t(19);u.connect(\"mongodb://localhost/ChatAppDB\");const m=s();m.use(d()),m.use(i.urlencoded({extended:!0})),m.use(i.json()),m.use(a.initialize()),m.set(\"view engine\",\"ejs\"),m.use(\"/user\",l),m.get(\"/\",(e,r)=>{r.send(\"You got home page!\\n\")}),m.get(\"/login\",(e,r)=>{r.render(\"login\",{})}),m.post(\"/login\",(e,r,t)=>{console.log(\"app.post('/login')\"),a.authenticate(\"local\",(n,s,o)=>o?r.send(o.message):n?t(n):s?void e.login(s,e=>e?t(e):r.redirect(\"/authrequired\")):r.redirect(\"/login\"))(e,r,t)}),m.get(\"/authrequired\",(e,r)=>{e.isAuthenticated()?r.send(\"you hit the authentication endpoint\\n\"):r.redirect(\"/\")}),m.get(\"/private\",n.authJwt,(e,r)=>{r.send(\"Private info!\")}),m.listen(3e3,()=>{console.log(\"Listening on localhost:3000\")}),e.exports=m},,function(e,r){e.exports=require(\"validator\")},function(e,r){e.exports=require(\"mongoose-unique-validator\")},function(e,r){e.exports=require(\"jsonwebtoken\")},function(e,r){e.exports=require(\"uuid/v4\")},function(e,r){e.exports=require(\"express-session\")},function(e,r){e.exports=require(\"session-file-store\")},function(e,r){e.exports=require(\"body-parser\")},function(e,r){e.exports=require(\"axios\")},function(e,r){e.exports=require(\"cors\")},function(e,r,t){\"use strict\";var n=i(t(20)),s=i(t(21)),o=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}(t(7));t(1);function i(e){return e&&e.__esModule?e:{default:e}}const a=t(0).Router(),u=t(7);a.get(\"/show\",u.getUser),a.post(\"/new\",u.createUser),a.get(\"/new\",u.newUser),a.post(\"/register\",(0,n.default)(s.default.loginUser),o.registerUser),a.get(\"/register\",u.newRegisterUser),a.post(\"/login\",o.loginUser),a.get(\"/show/:query\",u.showUser),a.post(\"/add_friend\",o.addFriend),e.exports=a},function(e,r){e.exports=require(\"express-validation\")},function(e,r,t){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(t(22));r.default={loginUser:{body:{email:n.default.string().email().required(),password:n.default.string().required(),name:n.default.string().required()}}}},function(e,r){e.exports=require(\"joi\")},function(e,r){e.exports=require(\"mongodb\")}]);","extractedComments":[]}