{"code":"module.exports=function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&n&&\"string\"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p=\"\",t(t.s=2)}([function(e,n){e.exports=require(\"express\")},function(e,n){e.exports=require(\"mongoose\")},function(e,n,t){\"use strict\";const r=t(0),o=t(3),s=t(4),i=t(5)(s),u=t(6),a=t(7),l=t(8).Strategy,c=t(9),d=t(10),f=t(1),p=t(11);f.connect(\"mongodb://localhost/ChatAppDB\"),a.use(new l({usernameField:\"email\"},(e,n,t)=>{User.find({name:\"newuser\"},function(e,n){if(console.log(n),0!=n.length){for(let e=0;e<n.length;e++)usersNames+=n[e].name;console.log(usersNames),res.send(usersNames)}else res.send(\"Sorry no user\")}).then(e=>{const r=e.data[0];return r&&d.compareSync(n,r.password)?t(null,r):t(null,!1,{message:\"Invalid credentials.\\n\"})}).catch(e=>t(e))})),a.serializeUser((e,n)=>{n(null,e.id)}),a.deserializeUser((e,n)=>{c.get(`http://localhost:5000/users/${e}`).then(e=>n(null,e.data)).catch(e=>n(e,!1))});const g=r();g.use(u.urlencoded({extended:!1})),g.use(u.json()),g.use(s({genid:e=>o(),store:new i,secret:\"keyboard cat\",resave:!1,saveUninitialized:!0})),g.use(a.initialize()),g.use(a.session()),g.set(\"view engine\",\"ejs\"),g.use(\"/user\",p),g.get(\"/\",(e,n)=>{n.send(\"You got home page!\\n\")}),g.get(\"/login\",(e,n)=>{n.render(\"login\",{})}),g.post(\"/login\",(e,n,t)=>{console.log(\"app.post('/login')\"),a.authenticate(\"local\",(r,o,s)=>s?n.send(s.message):r?t(r):o?void e.login(o,e=>e?t(e):n.redirect(\"/authrequired\")):n.redirect(\"/login\"))(e,n,t)}),g.get(\"/authrequired\",(e,n)=>{e.isAuthenticated()?n.send(\"you hit the authentication endpoint\\n\"):n.redirect(\"/\")}),g.listen(3e3,()=>{console.log(\"Listening on localhost:3000\")}),e.exports=g},function(e,n){e.exports=require(\"uuid/v4\")},function(e,n){e.exports=require(\"express-session\")},function(e,n){e.exports=require(\"session-file-store\")},function(e,n){e.exports=require(\"body-parser\")},function(e,n){e.exports=require(\"passport\")},function(e,n){e.exports=require(\"passport-local\")},function(e,n){e.exports=require(\"axios\")},function(e,n){e.exports=require(\"bcrypt-nodejs\")},function(e,n,t){\"use strict\";const r=t(0).Router(),o=t(12);r.get(\"/show\",o.getUser),r.post(\"/new\",o.createUser),r.get(\"/new\",o.newUser),r.post(\"/login\",o.loginUser),r.get(\"/login\",o.newLoginUser),e.exports=r},function(e,n,t){\"use strict\";Object.defineProperty(n,\"__esModule\",{value:!0}),n.loginUser=async function(e,n){try{const t=await r.create(e.body);return n.status(201).json(t)}catch(e){return n.status(500).json(e)}};const r=t(13);t(0);n.getUser=function(e,n){console.log(\"indexing users\");let t=\"\";r.find({name:\"Jimmy Testing\"},function(e,r){if(0!=r.length){for(let e=0;e<r.length;e++)t+=r[e].name;n.send(t)}else n.send(\"Sorry no user\")})},n.createUser=function(e,n){new r({name:e.body.name}).save(function(t){if(t)return console.log(t),next(t);n.send(\"Created user, \"+e.body.name)})},n.newUser=function(e,n){n.render(\"newUser\",{})},n.newLoginUser=function(e,n){console.log(\"newLoginUser\"),n.render(\"login\",{})}},function(e,n,t){\"use strict\";var r=s(t(1)),o=s(t(14));function s(e){return e&&e.__esModule?e:{default:e}}let i=new r.default.Schema({email:{type:String,unique:!0,required:[!0,\"Email address required!\"],validate:{validator:e=>o.default.isEmail(e)},message:\"{VALUE} is not a valid email.\"},name:{type:String,required:!0,max:100},password:{type:String}});e.exports=r.default.model(\"User\",i)},function(e,n){e.exports=require(\"validator\")}]);","extractedComments":[]}