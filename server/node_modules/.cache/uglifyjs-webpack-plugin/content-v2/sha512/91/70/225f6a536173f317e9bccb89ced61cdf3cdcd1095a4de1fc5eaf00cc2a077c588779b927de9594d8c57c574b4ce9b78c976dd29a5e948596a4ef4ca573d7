{"code":"module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=8)}([function(e,t){e.exports=require(\"express\")},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.authJwt=t.authLocal=void 0;var n=u(r(2)),o=u(r(3)),i=r(9),s=u(r(4));function u(e){return e&&e.__esModule?e:{default:e}}const a=new o.default({usernameField:\"email\"},async(e,t,r)=>{try{const n=await s.default.findOne({email:e});return console.log(n),n&&n.authenticateUser(t)?r(null,n):r(null,!1)}catch(e){return r(e,!1)}}),l={jwtFromRequest:i.ExtractJwt.fromAuthHeaderAsBearerToken(),secretOrKey:\"SecretKey\"},c=new i.Strategy(l,async(e,t)=>{try{const r=await s.default.findById(e._id);return t(null,r?r:!1)}catch(e){return t(e,!1)}});n.default.use(a),n.default.use(c);t.authLocal=n.default.authenticate(\"local\",{session:!1}),t.authJwt=n.default.authenticate(\"jwt\",{session:!1})},function(e,t){e.exports=require(\"passport\")},function(e,t){e.exports=require(\"passport-local\")},function(e,t,r){\"use strict\";var n=a(r(5)),o=a(r(10)),i=a(r(11)),s=r(6),u=a(r(12));function a(e){return e&&e.__esModule?e:{default:e}}let l=new n.default.Schema({email:{type:String,unique:!0,required:[!0,\"Email address required!\"],validate:{validator:e=>o.default.isEmail(e)},message:\"{VALUE} is not a valid email.\"},name:{type:String,required:!0,max:100},password:{type:String},conversations:{type:[String]}});l.plugin(i.default,{message:\"{VALUE} already taken!\"}),l.pre(\"save\",function(e){return this.isModified(\"password\")&&(this.password=this._hashPassword(this.password)),e()}),l.methods={_hashPassword:e=>(0,s.hashSync)(e),authenticateUser(e){return(0,s.compareSync)(e,this.password)},createToken(){return u.default.sign({_id:this._id},\"SecretKey\")},toJSON(){return{_id:this._id,name:this.name,token:`JWT ${this.createToken()}`,email:this.email}}},e.exports=n.default.model(\"User\",l)},function(e,t){e.exports=require(\"mongoose\")},function(e,t){e.exports=require(\"bcrypt-nodejs\")},,function(e,t,r){\"use strict\";var n=r(1);const o=r(0),i=(r(13),r(14)),s=(r(15)(i),r(16)),u=r(2);r(3).Strategy,r(17),r(6);r(5).connect(\"mongodb://localhost/ChatAppDB\");const a=o();a.use(s.urlencoded({extended:!0})),a.use(s.json()),a.use(u.initialize()),a.set(\"view engine\",\"ejs\"),a.use(\"/user\",user),a.get(\"/\",(e,t)=>{t.send(\"You got home page!\\n\")}),a.get(\"/login\",(e,t)=>{t.render(\"login\",{})}),a.post(\"/login\",(e,t,r)=>{console.log(\"app.post('/login')\"),u.authenticate(\"local\",(n,o,i)=>i?t.send(i.message):n?r(n):o?void e.login(o,e=>e?r(e):t.redirect(\"/authrequired\")):t.redirect(\"/login\"))(e,t,r)}),a.get(\"/authrequired\",(e,t)=>{e.isAuthenticated()?t.send(\"you hit the authentication endpoint\\n\"):t.redirect(\"/\")}),a.get(\"/private\",n.authJwt,(e,t)=>{t.send(\"Private info!\")}),a.listen(3e3,()=>{console.log(\"Listening on localhost:3000\")}),h,e.exports=a},function(e,t){e.exports=require(\"passport-jwt\")},function(e,t){e.exports=require(\"validator\")},function(e,t){e.exports=require(\"mongoose-unique-validator\")},function(e,t){e.exports=require(\"jsonwebtoken\")},function(e,t){e.exports=require(\"uuid/v4\")},function(e,t){e.exports=require(\"express-session\")},function(e,t){e.exports=require(\"session-file-store\")},function(e,t){e.exports=require(\"body-parser\")},function(e,t){e.exports=require(\"axios\")}]);","extractedComments":[]}