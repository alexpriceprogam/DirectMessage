{"code":"module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=3)}([function(e,t){e.exports=require(\"express\")},function(e,t){e.exports=require(\"mongoose\")},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.registerUser=async function(e,t){try{const r=await n.create(e.body);return console.log(r),t.status(201).json(r)}catch(e){return t.status(500).json(e)}},t.loginUser=async function(e,t,r){return t.status(200).json(e.user),t.send(\"hi hello\"),r()};const n=r(16);r(0);t.getUser=function(e,t){console.log(\"indexing users\");let r=\"\";n.find({name:\"Jimmy Testing\"},function(e,n){if(0!=n.length){for(let e=0;e<n.length;e++)r+=n[e].name;t.send(r)}else t.send(\"Sorry no user\")})},t.createUser=function(e,t){new n({name:e.body.name}).save(function(r){if(r)return console.log(r),next(r);t.send(\"Created user, \"+e.body.name)})},t.newUser=function(e,t){t.render(\"newUser\",{})},t.newRegisterUser=function(e,t){t.render(\"register\",{})},t.newLoginUser=function(e,t){t.render(\"register\",{})}},function(e,t,r){\"use strict\";const n=r(0),s=r(4),o=r(5),i=r(6)(o),u=r(7),a=r(8),l=r(9).Strategy,c=r(10),d=r(11),f=r(1),p=r(12);f.connect(\"mongodb://localhost/ChatAppDB\"),a.use(new l({usernameField:\"email\"},(e,t,r)=>{User.find({name:\"newuser\"},function(e,t){if(console.log(t),0!=t.length){for(let e=0;e<t.length;e++)usersNames+=t[e].name;console.log(usersNames),res.send(usersNames)}else res.send(\"Sorry no user\")}).then(e=>{const n=e.data[0];return n&&d.compareSync(t,n.password)?r(null,n):r(null,!1,{message:\"Invalid credentials.\\n\"})}).catch(e=>r(e))})),a.serializeUser((e,t)=>{t(null,e.id)}),a.deserializeUser((e,t)=>{c.get(`http://localhost:5000/users/${e}`).then(e=>t(null,e.data)).catch(e=>t(e,!1))});const g=n();g.use(u.urlencoded({extended:!0})),g.use(u.json()),g.use(o({genid:e=>s(),store:new i,secret:\"keyboard cat\",resave:!1,saveUninitialized:!0})),g.use(a.initialize()),g.use(a.session()),g.set(\"view engine\",\"ejs\"),g.use(\"/user\",p),g.get(\"/\",(e,t)=>{t.send(\"You got home page!\\n\")}),g.get(\"/login\",(e,t)=>{t.render(\"login\",{})}),g.post(\"/login\",(e,t,r)=>{console.log(\"app.post('/login')\"),a.authenticate(\"local\",(n,s,o)=>o?t.send(o.message):n?r(n):s?void e.login(s,e=>e?r(e):t.redirect(\"/authrequired\")):t.redirect(\"/login\"))(e,t,r)}),g.get(\"/authrequired\",(e,t)=>{e.isAuthenticated()?t.send(\"you hit the authentication endpoint\\n\"):t.redirect(\"/\")}),g.listen(3e3,()=>{console.log(\"Listening on localhost:3000\")}),e.exports=g},function(e,t){e.exports=require(\"uuid/v4\")},function(e,t){e.exports=require(\"express-session\")},function(e,t){e.exports=require(\"session-file-store\")},function(e,t){e.exports=require(\"body-parser\")},function(e,t){e.exports=require(\"passport\")},function(e,t){e.exports=require(\"passport-local\")},function(e,t){e.exports=require(\"axios\")},function(e,t){e.exports=require(\"bcrypt-nodejs\")},function(e,t,r){\"use strict\";var n=i(r(13)),s=i(r(14)),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}(r(2));function i(e){return e&&e.__esModule?e:{default:e}}const u=r(0).Router(),a=r(2);u.get(\"/show\",a.getUser),u.post(\"/new\",a.createUser),u.get(\"/new\",a.newUser),u.post(\"/register\",(0,n.default)(s.default.loginUser),o.registerUser),u.get(\"/register\",a.newRegisterUser),u.post(\"/login\",o.loginUser),e.exports=u},function(e,t){e.exports=require(\"express-validation\")},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(15));t.default={loginUser:{body:{email:n.default.string().email().required(),password:n.default.string().required(),name:n.default.string().required()}}}},function(e,t){e.exports=require(\"joi\")},function(e,t,r){\"use strict\";var n=i(r(1)),s=i(r(17)),o=i(r(18));function i(e){return e&&e.__esModule?e:{default:e}}let u=new n.default.Schema({email:{type:String,unique:!0,required:[!0,\"Email address required!\"],validate:{validator:e=>s.default.isEmail(e)},message:\"{VALUE} is not a valid email.\"},name:{type:String,required:!0,max:100},password:{type:String}});u.plugin(o.default,{message:\"{VALUE} already taken!\"}),u.pre(\"save\",function(e){return this.isModified(\"password\")&&(this.password=this._hashPassword(this.password)),e()}),u.methods={_hashPassword:e=>hashSync(e),authenticateUser(e){return compareSync(e,this.password)}},e.exports=n.default.model(\"User\",u)},function(e,t){e.exports=require(\"validator\")},function(e,t){e.exports=require(\"mongoose-unique-validator\")}]);","extractedComments":[]}