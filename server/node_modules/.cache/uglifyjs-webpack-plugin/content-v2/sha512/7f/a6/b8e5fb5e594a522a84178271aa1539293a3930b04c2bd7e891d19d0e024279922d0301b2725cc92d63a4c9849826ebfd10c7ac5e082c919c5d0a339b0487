{"code":"module.exports=function(e){var r={};function s(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=e,s.c=r,s.d=function(e,r,t){s.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},s.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},s.t=function(e,r){if(1&r&&(e=s(e)),8&r)return e;if(4&r&&\"object\"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,\"default\",{enumerable:!0,value:e}),2&r&&\"string\"!=typeof e)for(var a in e)s.d(t,a,function(r){return e[r]}.bind(null,a));return t},s.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(r,\"a\",r),r},s.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},s.p=\"\",s(s.s=8)}([function(e,r){e.exports=require(\"express\")},function(e,r,s){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0}),r.authJwt=r.authLocal=void 0;var t=i(s(2)),a=i(s(3)),n=s(9),o=i(s(4));function i(e){return e&&e.__esModule?e:{default:e}}const d=new a.default({usernameField:\"email\"},async(e,r,s)=>{try{const t=await o.default.findOne({email:e});return console.log(t),t&&t.authenticateUser(r)?s(null,t):s(null,!1)}catch(e){return s(e,!1)}}),l={jwtFromRequest:n.ExtractJwt.fromAuthHeaderAsBearerToken(),secretOrKey:\"SecretKey\"},m=new n.Strategy(l,async(e,r)=>{try{const s=await o.default.findById(e._id);return r(null,s?s:!1)}catch(e){return r(e,!1)}});t.default.use(d),t.default.use(m);r.authLocal=t.default.authenticate(\"local\",{session:!1}),r.authJwt=t.default.authenticate(\"jwt\",{session:!1})},function(e,r){e.exports=require(\"passport\")},function(e,r){e.exports=require(\"passport-local\")},function(e,r,s){\"use strict\";var t=d(s(5)),a=d(s(10)),n=d(s(11)),o=s(6),i=d(s(12));function d(e){return e&&e.__esModule?e:{default:e}}let l=new t.default.Schema({email:{type:String,unique:!0,required:[!0,\"Email address required!\"],validate:{validator:e=>a.default.isEmail(e)},message:\"{VALUE} is not a valid email.\"},name:{type:String,required:!0,max:100},password:{type:String},conversations:{type:[String]}});l.plugin(n.default,{message:\"{VALUE} already taken!\"}),l.pre(\"save\",function(e){return this.isModified(\"password\")&&(this.password=this._hashPassword(this.password)),e()}),l.methods={_hashPassword:e=>(0,o.hashSync)(e),authenticateUser(e){return(0,o.compareSync)(e,this.password)},createToken(){return i.default.sign({_id:this._id},\"SecretKey\")},toJSON(){return{_id:this._id,name:this.name,token:`JWT ${this.createToken()}`,email:this.email}}},e.exports=t.default.model(\"User\",l)},function(e,r){e.exports=require(\"mongoose\")},function(e,r){e.exports=require(\"bcrypt-nodejs\")},function(e,r,s){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0}),r.registerUser=async function(e,r){try{const s=await t.create(e.body);return console.log(s),r.status(201).json(s)}catch(e){return r.status(500).json(e)}},r.loginUser=function(e,r,s){return console.log(e.user),r.status(200).json(e.user.toJSON()),s()};const t=s(4);s(0);r.getUser=function(e,r){console.log(\"indexing users\");let s=\"\";t.find({name:\"Jimmy Testing\"},function(e,t){if(0!=t.length){for(let e=0;e<t.length;e++)s+=t[e].name;r.send(s)}else r.send(\"Sorry no user\")})},r.createUser=function(e,r){new t({name:e.body.name}).save(function(s){if(s)return console.log(s),next(s);r.send(\"Created user, \"+e.body.name)})},r.newUser=function(e,r){r.render(\"newUser\",{})},r.newRegisterUser=function(e,r){r.render(\"register\",{})},r.newLoginUser=function(e,r){r.render(\"register\",{})}},function(e,r,s){\"use strict\";var t=s(24),a=s(26),n=s(1);const o=s(0),i=(s(13),s(14)),d=(s(15)(i),s(16)),l=s(2),m=(s(3).Strategy,s(17),s(6),s(5)),u=s(18);m.connect(\"mongodb://localhost/ChatAppDB\");const c=o();c.use(d.urlencoded({extended:!0})),c.use(d.json()),c.use(l.initialize()),c.set(\"view engine\",\"ejs\"),c.use(\"/user\",u),c.use(\"/message\",t.message),c.use(\"/conversation\",a.conversation),c.get(\"/\",(e,r)=>{r.send(\"You got home page!\\n\")}),c.get(\"/login\",(e,r)=>{r.render(\"login\",{})}),c.post(\"/login\",(e,r,s)=>{console.log(\"app.post('/login')\"),l.authenticate(\"local\",(t,a,n)=>n?r.send(n.message):t?s(t):a?void e.login(a,e=>e?s(e):r.redirect(\"/authrequired\")):r.redirect(\"/login\"))(e,r,s)}),c.get(\"/authrequired\",(e,r)=>{e.isAuthenticated()?r.send(\"you hit the authentication endpoint\\n\"):r.redirect(\"/\")}),c.get(\"/private\",n.authJwt,(e,r)=>{r.send(\"Private info!\")}),c.listen(3e3,()=>{console.log(\"Listening on localhost:3000\")}),h,e.exports=c},function(e,r){e.exports=require(\"passport-jwt\")},function(e,r){e.exports=require(\"validator\")},function(e,r){e.exports=require(\"mongoose-unique-validator\")},function(e,r){e.exports=require(\"jsonwebtoken\")},function(e,r){e.exports=require(\"uuid/v4\")},function(e,r){e.exports=require(\"express-session\")},function(e,r){e.exports=require(\"session-file-store\")},function(e,r){e.exports=require(\"body-parser\")},function(e,r){e.exports=require(\"axios\")},function(e,r,s){\"use strict\";var t=i(s(19)),a=i(s(20)),n=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var t=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,s):{};t.get||t.set?Object.defineProperty(r,s,t):r[s]=e[s]}return r.default=e,r}(s(7)),o=s(1);function i(e){return e&&e.__esModule?e:{default:e}}const d=s(0).Router(),l=s(7);d.get(\"/show\",l.getUser),d.post(\"/new\",l.createUser),d.get(\"/new\",l.newUser),d.post(\"/register\",(0,t.default)(a.default.loginUser),n.registerUser),d.get(\"/register\",l.newRegisterUser),d.post(\"/login\",o.authLocal,n.loginUser),e.exports=d},function(e,r){e.exports=require(\"express-validation\")},function(e,r,s){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0});var t=function(e){return e&&e.__esModule?e:{default:e}}(s(21));r.default={loginUser:{body:{email:t.default.string().email().required(),password:t.default.string().required(),name:t.default.string().required()}}}},function(e,r){e.exports=require(\"joi\")},function(e,r,s){\"use strict\";s(25);s(0)},function(e,r,s){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0}),r.registerConversation=async function(e,r){try{const s=await t.create(e.body);return console.log(s),r.status(201).json(s)}catch(e){return r.status(500).json(e)}},r.loginConversation=function(e,r,s){return console.log(e.conversation),r.status(200).json(e.conversation.toJSON()),s()};const t=s(27);s(0);r.getConversation=function(e,r){console.log(\"indexing conversations\");let s=\"\";t.find({name:\"Jimmy Testing\"},function(e,t){if(0!=t.length){for(let e=0;e<t.length;e++)s+=t[e].name;r.send(s)}else r.send(\"Sorry no conversation\")})},r.createConversation=function(e,r){new t({name:e.body.name}).save(function(s){if(s)return console.log(s),next(s);r.send(\"Created conversation, \"+e.body.name)})},r.newConversation=function(e,r){r.render(\"newConversation\",{})},r.newRegisterConversation=function(e,r){r.render(\"register\",{})},r.newLoginConversation=function(e,r){r.render(\"register\",{})}},function(e,r,s){\"use strict\";(function(e){e&&e.__esModule})(s(19)),function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var t=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,s):{};t.get||t.set?Object.defineProperty(r,s,t):r[s]=e[s]}r.default=e}(s(22));const t=s(0).Router(),a=s(22);t.get(\"/show\",a.getMessage),t.post(\"/new\",a.createMessage),t.get(\"/new\",a.newMessage),e.exports=t},function(e,r){throw new Error('Module build failed (from ./node_modules/babel-loader/lib/index.js):\\nSyntaxError: /home/adam/Gits/DirectMessager/server/models/message.model.js: Unexpected token, expected \",\" (7:2)\\n\\n\u001b[0m \u001b[90m  5 | \u001b[39m  \\ttype\u001b[33m:\u001b[39m \u001b[33mString\u001b[39m\u001b[0m\\n\u001b[0m \u001b[90m  6 | \u001b[39m  }\u001b[0m\\n\u001b[0m\u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m  7 | \u001b[39m  content\u001b[33m:\u001b[39m {\u001b[0m\\n\u001b[0m \u001b[90m    | \u001b[39m  \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\u001b[0m\\n\u001b[0m \u001b[90m  8 | \u001b[39m    type\u001b[33m:\u001b[39m [\u001b[33mString\u001b[39m]\u001b[33m,\u001b[39m\u001b[0m\\n\u001b[0m \u001b[90m  9 | \u001b[39m    unique\u001b[33m:\u001b[39m \u001b[36mtrue\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\\n\u001b[0m \u001b[90m 10 | \u001b[39m  }\u001b[0m\\n    at Parser.raise (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:3939:15)\\n    at Parser.unexpected (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5248:16)\\n    at Parser.expect (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5236:28)\\n    at Parser.parseObj (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:6644:14)\\n    at Parser.parseExprAtom (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:6294:21)\\n    at Parser.parseExprSubscripts (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5924:21)\\n    at Parser.parseMaybeUnary (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5903:21)\\n    at Parser.parseExprOps (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5812:21)\\n    at Parser.parseMaybeConditional (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5784:21)\\n    at Parser.parseMaybeAssign (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5731:21)\\n    at Parser.parseExprListItem (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7003:18)\\n    at Parser.parseExprList (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:6983:22)\\n    at Parser.parseNewArguments (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:6585:23)\\n    at Parser.parseNew (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:6579:10)\\n    at Parser.parseExprAtom (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:6308:21)\\n    at Parser.parseExprSubscripts (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5924:21)\\n    at Parser.parseMaybeUnary (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5903:21)\\n    at Parser.parseExprOps (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5812:21)\\n    at Parser.parseMaybeConditional (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5784:21)\\n    at Parser.parseMaybeAssign (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5731:21)\\n    at Parser.parseVar (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7776:26)\\n    at Parser.parseVarStatement (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7606:10)\\n    at Parser.parseStatementContent (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7203:21)\\n    at Parser.parseStatement (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7153:17)\\n    at Parser.parseBlockOrModuleBlockBody (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7707:23)\\n    at Parser.parseBlockBody (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7694:10)\\n    at Parser.parseTopLevel (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7118:10)\\n    at Parser.parse (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:8521:17)\\n    at parse (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:10513:38)\\n    at parser (/home/adam/Gits/DirectMessager/server/node_modules/@babel/core/lib/transformation/normalize-file.js:170:34)\\n    at normalizeFile (/home/adam/Gits/DirectMessager/server/node_modules/@babel/core/lib/transformation/normalize-file.js:138:11)\\n    at runSync (/home/adam/Gits/DirectMessager/server/node_modules/@babel/core/lib/transformation/index.js:44:43)\\n    at runAsync (/home/adam/Gits/DirectMessager/server/node_modules/@babel/core/lib/transformation/index.js:35:14)\\n    at process.nextTick (/home/adam/Gits/DirectMessager/server/node_modules/@babel/core/lib/transform.js:34:34)\\n    at process._tickCallback (internal/process/next_tick.js:150:11)')},function(e,r,s){\"use strict\";(function(e){e&&e.__esModule})(s(19)),function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var t=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,s):{};t.get||t.set?Object.defineProperty(r,s,t):r[s]=e[s]}r.default=e}(s(23));const t=s(0).Router(),a=s(23);t.get(\"/show\",a.getConversation),t.post(\"/new\",a.createConversation),t.get(\"/new\",a.newConversation),e.exports=t},function(e,r){throw new Error('Module build failed (from ./node_modules/babel-loader/lib/index.js):\\nSyntaxError: /home/adam/Gits/DirectMessager/server/models/conversation.model.js: Unexpected token, expected \",\" (9:13)\\n\\n\u001b[0m \u001b[90m  7 | \u001b[39m\\t\\t}\u001b[0m\\n\u001b[0m \u001b[90m  8 | \u001b[39m\\t}\u001b[33m,\u001b[39m\u001b[0m\\n\u001b[0m\u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m  9 | \u001b[39m  message_log\u001b[33m:\u001b[39m {\u001b[0m\\n\u001b[0m \u001b[90m    | \u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\u001b[0m\\n\u001b[0m \u001b[90m 10 | \u001b[39m    type\u001b[33m:\u001b[39m [\u001b[33mString\u001b[39m]\u001b[33m,\u001b[39m\u001b[0m\\n\u001b[0m \u001b[90m 11 | \u001b[39m    unique\u001b[33m:\u001b[39m \u001b[36mtrue\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\\n\u001b[0m \u001b[90m 12 | \u001b[39m  }\u001b[0m\\n    at Parser.raise (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:3939:15)\\n    at Parser.unexpected (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5248:16)\\n    at Parser.expect (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5236:28)\\n    at Parser.parseExprList (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:6979:14)\\n    at Parser.parseNewArguments (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:6585:23)\\n    at Parser.parseNew (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:6579:10)\\n    at Parser.parseExprAtom (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:6308:21)\\n    at Parser.parseExprSubscripts (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5924:21)\\n    at Parser.parseMaybeUnary (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5903:21)\\n    at Parser.parseExprOps (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5812:21)\\n    at Parser.parseMaybeConditional (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5784:21)\\n    at Parser.parseMaybeAssign (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:5731:21)\\n    at Parser.parseVar (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7776:26)\\n    at Parser.parseVarStatement (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7606:10)\\n    at Parser.parseStatementContent (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7203:21)\\n    at Parser.parseStatement (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7153:17)\\n    at Parser.parseBlockOrModuleBlockBody (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7707:23)\\n    at Parser.parseBlockBody (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7694:10)\\n    at Parser.parseTopLevel (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:7118:10)\\n    at Parser.parse (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:8521:17)\\n    at parse (/home/adam/Gits/DirectMessager/server/node_modules/@babel/parser/lib/index.js:10513:38)\\n    at parser (/home/adam/Gits/DirectMessager/server/node_modules/@babel/core/lib/transformation/normalize-file.js:170:34)\\n    at normalizeFile (/home/adam/Gits/DirectMessager/server/node_modules/@babel/core/lib/transformation/normalize-file.js:138:11)\\n    at runSync (/home/adam/Gits/DirectMessager/server/node_modules/@babel/core/lib/transformation/index.js:44:43)\\n    at runAsync (/home/adam/Gits/DirectMessager/server/node_modules/@babel/core/lib/transformation/index.js:35:14)\\n    at process.nextTick (/home/adam/Gits/DirectMessager/server/node_modules/@babel/core/lib/transform.js:34:34)\\n    at process._tickCallback (internal/process/next_tick.js:150:11)')}]);","extractedComments":[]}